!function(){"use strict";var a=angular.module("illumination");a.directive("gpio",[function(){return{restrict:"E",templateUrl:"plugins/plugins/gpios/template/template.html",controller:"gpioController",controllerAs:"gpioCtrl",replace:!0}}]),a.controller("gpioController",["gpioService","$timeout","socket","eventEmitter",function(a,b,c,d){var e=this;c.on("update",function(a){for(var b=0;b<e.gpios.length;b++)for(var c=0;c<a.length;c++)e.gpios[b].gpio==a[c].gpio&&(e.gpios[b].state=a[c].state);for(var b=0;b<e.gpios.length;b++)$("[name='bootstrap-switch-"+e.gpios[b].gpio+"']").bootstrapSwitch("state",e.gpios[b].state)}),d.on("enableGpios",function(){for(var a=0;a<e.gpios.length;a++)$("[name='bootstrap-switch-"+e.gpios[a].gpio+"']").bootstrapSwitch("disabled",!1);c.emit("getUpdate")}),d.on("disableGpios",function(){for(var a=0;a<e.gpios.length;a++)$("[name='bootstrap-switch-"+e.gpios[a].gpio+"']").bootstrapSwitch("disabled",!0)}),a.getGPIOs(function(c){e.gpios=c,b(function(){for(var b=0;b<e.gpios.length;b++){var c=$("[name='bootstrap-switch-"+e.gpios[b].gpio+"']").bootstrapSwitch();c.on("switchChange.bootstrapSwitch",function(b,c){var d=b.currentTarget.attributes.customid.value;a.setGPIOs(d,c,function(){})})}for(var b=0;b<e.gpios.length;b++)$("[name='bootstrap-switch-"+e.gpios[b].gpio+"']").bootstrapSwitch("state",e.gpios[b].state)},100)})}]),a.service("gpioService",["$http",function(a){var b={getGPIOs:function(b){var c=a.get("/gpio");c.then(function(a){b(a.data)},function(a){b([]),console.log(a)})},setGPIOs:function(b,c,d){a.put("/gpio",{gpio:b,state:c},{headers:{"Content-Type":"application/json"}})}};return b}])}();